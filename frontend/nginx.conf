server {
  # Nginx inside frontend container listens on port 80
  listen 80;

  # Directory where Vue build files are stored
  root /usr/share/nginx/html;

  # Default file
  index index.html;

  # Enable MIME types
  include /etc/nginx/mime.types;
  default_type application/octet-stream;

  # Vue Router (history mode) support
  # This must only catch HTML routes, not static assets
  location / {
    try_files $uri $uri/ /index.html;
  }

  # Explicitly handle JavaScript files with correct MIME type
  location ~* \.js$ {
    add_header Content-Type application/javascript;
    try_files $uri =404;
  }

  # Explicitly handle CSS files
  location ~* \.css$ {
    add_header Content-Type text/css;
    try_files $uri =404;
  }

  # Static assets (images, fonts, etc.)
  location ~* \.(jpg|jpeg|png|gif|ico|svg|woff|woff2|ttf|eot)$ {
    expires 1y;
    add_header Cache-Control "public, immutable";
  }
}
